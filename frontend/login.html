<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>AutoGest - Login</title>

<style>
body {
    background-color: #1a1a2e;
    font-family: Arial, sans-serif;
    display:flex;
    justify-content:center;
    align-items:center;
    height:100vh;
}

.login-box {
    background:#16213e;
    padding:40px;
    border-radius:10px;
    width:300px;
}

h2 {
    color:white;
    text-align:center;
}

input {
    width:100%;
    padding:10px;
    margin:10px 0;
    border:none;
    border-radius:5px;
}

button {
    width:100%;
    padding:10px;
    background:#e94560;
    color:white;
    border:none;
    border-radius:5px;
    cursor:pointer;
}

button:hover {
    opacity:0.9;
}

.erro {
    color:red;
    text-align:center;
}
</style>
</head>

<body>

<div class="login-box">
    <h2>AutoGest</h2>

    <input type="text" id="username" placeholder="Email">
    <input type="password" id="password" placeholder="Senha">

    <button id="btnLogin">Entrar</button>

    <p class="erro" id="erro"></p>
</div>

<script>
document.getElementById("btnLogin").addEventListener("click", async function() {
    const username = document.getElementById("username").value;
    const password = document.getElementById("password").value;

    try {
        const response = await fetch("http://127.0.0.1:8000/login", {
            method: "POST",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify({
                email: username,  // Ajustado para o backend
                senha: password   // Ajustado para o backend
            })
        });

        if (response.ok) {
            const data = await response.json();
            localStorage.setItem("token", data.access_token);
            alert("Login realizado com sucesso!");
            window.location.href = "dashboard.html";
        } else {
            // Agora o backend vai reconhecer e não dará mais erro 400
            document.getElementById("erro").innerText = "Usuário ou senha inválidos";
        }
    } catch (error) {
        document.getElementById("erro").innerText = "Erro ao conectar com o servidor";
        console.error(error);
    }
});
</script>

</body>
</html>
